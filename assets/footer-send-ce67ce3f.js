import{a as g,S as $}from"./vendor-cfb45d56.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();class x{constructor(){}getOptions(){return JSON.parse(localStorage.getItem("options"))}setOptions(t){localStorage.setItem("options",JSON.stringify(t))}getCart(){return localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):[]}createAndSave(t,s){localStorage.setItem(t,JSON.stringify(s))}getFromStorage(t){return JSON.parse(localStorage.getItem(`${t}`))}saveCardsToLocalStorage(t){localStorage.setItem("products",JSON.stringify(t))}saveCategories(){if(!localStorage.getItem("categories"))return m.getCategories().then(t=>{localStorage.setItem("categories",JSON.stringify(t))})}defaultApiOptions(){const t={keyword:null,category:null,page:1,limit:6};localStorage.getItem("options"),localStorage.setItem("options",JSON.stringify(t))}setApiOptions(t,s){const r=JSON.parse(localStorage.getItem("options"));r[t]=s,localStorage.setItem("options",JSON.stringify(r))}addToCart(t){const r=JSON.parse(localStorage.getItem("products")).find(o=>o._id===t);this.addProductToCart(r)}addProductToCart(t){if(!localStorage.getItem("cart")||localStorage.getItem("cart").length===0){const s=[t];localStorage.setItem("cart",JSON.stringify(s))}else{const s=JSON.parse(localStorage.getItem("cart"));if(s.find(r=>t._id===r._id))return;s.push(t),localStorage.setItem("cart",JSON.stringify(s))}}removeFromCart(t){const s=JSON.parse(localStorage.getItem("cart")),r=s.find(a=>a._id===t),o=s.indexOf(r);return s.splice(o,1),localStorage.setItem("cart",JSON.stringify(s))}clearCart(){localStorage.removeItem("cart")}}class F{constructor(){this.URL="https://food-boutique.b.goit.study/api"}getFoodListWithOptions2(t){window.innerWidth>=768&&window.innerWidth<1440?(t.limit=8,n.setOptions(t)):window.innerWidth>=1440&&(t.limit=9,n.setOptions(t));const s={page:t.page,limit:t.limit,keyword:t.keyword!==null?t.keyword:void 0,category:t.category!==null?t.category:void 0};return Object.keys(s).forEach(r=>s[r]===void 0&&delete s[r]),g.get(`${this.URL}/products`,{params:s}).then(r=>r.data)}findProductById(t){return g.get(`${this.URL}/products/${t}`).then(s=>s.data)}getPopular(){return g.get(`${this.URL}/products/popular`).then(t=>t.data)}getDiscount(){return g.get(`${this.URL}/products/discount`).then(t=>t.data)}getCategories(){return g.get(`${this.URL}/products/categories`).then(t=>t.data)}subscribe(t){return g.post(`${this.URL}/subscription`,{email:t})}order(t,s){return g.post(`${this.URL}/orders`,{email:t,products:s})}}const R=new x,A=document.querySelector(".cart-title");function D(){return(R.getFromStorage("cart")??[]).length}function v(){let e=D();A.innerHTML=`cart (${e})`}v();const U="/project-code_busters09/assets/cart-a9135e8e.svg",T="/project-code_busters09/assets/cartLight-0b4d3d6f.svg",w="/project-code_busters09/assets/discount-b955391f.svg",y="/project-code_busters09/assets/checked-295f5189.svg";function q(){document.addEventListener("click",function(e){if(e.target.classList.contains("cart-img-products")||e.target.classList.contains("main-cart-icon")||e.target.classList.contains("popular-cart-img")||e.target.classList.contains("popular-cart-img-down")){const t=e.target;t.src=y}})}function N(e){e&&e.classList.add("visually-hidden")}function k(e){e&&e.classList.remove("visually-hidden")}const L=document.querySelector(".loader-container");function z(){L&&(L.style.display="flex")}function W(){L&&(L.style.display="none")}const G=localStorage.getItem("options"),K=JSON.parse(G),M=document.querySelector(".no-products-message"),P=document.querySelector(".pagination"),J=document.querySelector(".filter-box__list"),b=document.querySelector(".popular-products__list"),H=document.querySelector(".discount-products__list"),n=new x,m=new F;document.addEventListener("click",function(e){e.target.tagName==="IMG"&&e.preventDefault()});n.defaultApiOptions();O();C();E();q();document.addEventListener("click",Q);function Q(e){if(e.target&&e.target.classList.contains("main-cart-icon")){const t=e.target.dataset.productId;n.addToCart(t),v(),O(),C(),E()}else if(e.target&&(e.target.classList.contains("cart-img-products")||e.target.classList.contains("popular-cart-img"))){const t=e.target.dataset.productId;m.findProductById(t).then(s=>{n.addProductToCart(s),v(),O(),C(),E()})}}function O(){const e=JSON.parse(localStorage.getItem("options"));z(),m.getFoodListWithOptions2(e).then(t=>{t.totalPages<2||K.limit<6||t.results.length===0?N(P):k(P),t.results.length===0?k(M):N(M),J&&(J.innerHTML=X(t.results)),W(),n.saveCardsToLocalStorage(t.results),n.createAndSave("pagination",t)}).catch(t=>{})}function C(){m.getPopular().then(e=>{b&&(b.innerHTML=Y(e))}).catch(e=>{})}function E(){m.getDiscount().then(e=>{H&&(H.innerHTML=j(e))}).catch(e=>{})}function X(e){const t=n.getCart();return e.map(({_id:s,name:r,img:o,category:a,price:c,popularity:l,size:u,is10PercentOff:d})=>{const i=document.createElement("img");i.src=U,i.classList.add("main-cart-icon"),i.dataset.productId=s;let f=a.replace(/_/g," ");const h=document.createElement("img");h.src=w,h.classList.add("discount-icon-products");const p=d?h.outerHTML:"",S=document.createElement("img");S.src=y,S.classList.add("js-checked-arrow");const I=t.some(_=>_._id===s);return`<li class="product-card" data-id=${s}>
          ${p}
          <div class="img-container"><a href="${o}"><img class="product-card__img" src="${o}" alt="${r}" loading="lazy" /></a>
          </div>
          <div class="info">      
            <h2 class="info__title">${r}</h2>
            <div class="info-wrapper">
              <p class="info-wrapper__product">Category:<span>${f}</span></p>
              <p class="info-wrapper__product">Size:<span>${u}</span></p>
              <p class="info-wrapper__product">Popularity:<span>${l}</span></p>
            </div>
            <div class="info-wrapper__price-container" >
              <p class="info__price">$${c}</p> 
              ${I?S.outerHTML:i.outerHTML}
            </div>     
          </div>
        </li>`}).join("")}function Y(e){const t=n.getCart();return e.map(({_id:s,name:r,img:o,category:a,popularity:c,size:l,is10PercentOff:u})=>{const d=document.createElement("img");d.src=T,d.classList.add("popular-cart-img"),d.dataset.productId=s,d.alt="add to cart";const i=document.createElement("img");i.src=T,i.classList.add("popular-cart-img-down");const f=document.createElement("img");f.src=w,f.classList.add("discount-icon-popular");const h=u?`${f.outerHTML}${i.outerHTML}`:`${d.outerHTML}`,p=document.createElement("img");p.src=y,p.classList.add("popular-cart-img"),p.dataset.productId=s,p.alt="added to cart";const S=t.some(_=>_._id===s);let I=a.replace(/_/g," ");return`      
        <li class="popular-item" data-id="${s}">
            ${S?p.outerHTML:h}
          <div class="popular-img-container"><img class="popular-item__img" src="${o}" alt="${r}" loading="lazy" /></div>
          <div class="popular-info">
            <h3 class="popular-info__title">${r}</h3>
            <div class="info-wrapper">
              <p class="info-wrapper__product">Category:<span>${I}</span></p>
              <p class="info-wrapper__product">Size:<span>${l}</span></p>
              <p class="info-wrapper__product">Popularity:<span>${c}</span></p>
            </div>             
          </div>
        </li>`}).slice(0,5).join("")}function j(e){const t=n.getCart();return e.map(({_id:s,name:r,img:o,price:a})=>{const c=document.createElement("img");c.src=U,c.classList.add("cart-img-products"),c.dataset.productId=s,c.alt="add to cart";const l=document.createElement("img");l.src=w,l.classList.add("discount-cheap"),l.alt="discounted product";const u=document.createElement("img");u.src=y,u.classList.add("js-checked-arrow");const d=t.some(i=>i._id===s);return`      
      <li class="discount-item" data-id="${s}">
   
       ${l.outerHTML} 
      <div class="discount-img-container"><a href="${o}"><img class="discount-item__img" src="${o}" alt="${r}" loading="lazy" /></a>
      </div>
      <div class="discount-info">
        <h3 class="discount-info__title">${r}</h3>
        <div class="discount-img-wrapper">
        <p class="discount-info__price">$${a}</p>
         ${d?u.outerHTML:c.outerHTML}
        </div>        
      </div>
    </li>`}).slice(0,2).join("")}const et="/project-code_busters09/assets/icons-91d3aeb0.svg",B=document.getElementById("subscriptionForm");B.addEventListener("submit",V);function V(e){e.preventDefault();const t=document.getElementById("emailInput");if(t){const s=t.value;s!==""&&m.subscribe(s).then(r=>{r.status===201&&($.fire({title:"Subscription is complete",text:r.data.message,icon:"success",confirmButtonText:"Back to products"}),Z(B))}).catch(r=>{r.response.status===409?$.fire({title:"Already subscribed!",text:"Your email is already subscribed!",icon:"info",confirmButtonText:"Back to products"}):r.response.status===400&&$.fire({title:"Error",text:"Invalid email",icon:"error",confirmButtonText:"Back to products"})})}}function Z(e){Array.from(e.elements).forEach(t=>{t.tagName==="INPUT"||t.tagName==="TEXTAREA"?t.value="":t.tagName==="SELECT"&&(t.selectedIndex=0)})}export{z as a,O as c,E as d,m as f,W as h,et as i,C as p,n as s,v as u};
//# sourceMappingURL=footer-send-ce67ce3f.js.map
