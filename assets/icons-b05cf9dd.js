import{a as m}from"./vendor-99d50140.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const a of c.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function e(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerpolicy&&(c.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?c.credentials="include":o.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(o){if(o.ep)return;o.ep=!0;const c=e(o);fetch(o.href,c)}})();class T{constructor(){}getOptions(){return JSON.parse(localStorage.getItem("options"))}setOptions(t){localStorage.setItem("options",JSON.stringify(t))}getCart(){return localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):[]}createAndSave(t,e){localStorage.setItem(t,JSON.stringify(e))}getFromStorage(t){return JSON.parse(localStorage.getItem(`${t}`))}saveCardsToLocalStorage(t){localStorage.setItem("products",JSON.stringify(t))}saveCategories(){if(!localStorage.getItem("categories"))return f.getCategories().then(t=>{console.log(t),localStorage.setItem("categories",JSON.stringify(t))})}defaultApiOptions(){const t={keyword:null,category:null,page:1,limit:6};localStorage.getItem("options"),localStorage.setItem("options",JSON.stringify(t))}setApiOptions(t,e){const r=JSON.parse(localStorage.getItem("options"));r[t]=e,localStorage.setItem("options",JSON.stringify(r))}addToCart(t){const r=JSON.parse(localStorage.getItem("products")).find(o=>o._id===t);this.addProductToCart(r)}addProductToCart(t){if(!localStorage.getItem("cart")||localStorage.getItem("cart").length===0){const e=[t];localStorage.setItem("cart",JSON.stringify(e))}else{const e=JSON.parse(localStorage.getItem("cart"));if(e.find(r=>t._id===r._id))return;e.push(t),localStorage.setItem("cart",JSON.stringify(e))}}removeFromCart(t){const e=JSON.parse(localStorage.getItem("cart")),r=e.find(c=>c._id===t),o=e.indexOf(r);return e.splice(o,1),console.log(e),localStorage.setItem("cart",JSON.stringify(e))}clearCart(){localStorage.removeItem("cart")}}class P{constructor(){this.URL="https://food-boutique.b.goit.study/api"}getFoodListWithOptions2(t){window.innerWidth>=768&&window.innerWidth<1440?(t.limit=8,i.setOptions(t)):window.innerWidth>=1440&&(t.limit=9,i.setOptions(t));const e={page:t.page,limit:t.limit,keyword:t.keyword!==null?t.keyword:void 0,category:t.category!==null?t.category:void 0};return Object.keys(e).forEach(r=>e[r]===void 0&&delete e[r]),m.get(`${this.URL}/products`,{params:e}).then(r=>r.data)}findProductById(t){return m.get(`${this.URL}/products/${t}`).then(e=>e.data)}getPopular(){return m.get(`${this.URL}/products/popular`).then(t=>t.data)}getDiscount(){return m.get(`${this.URL}/products/discount`).then(t=>t.data)}getCategories(){return m.get(`${this.URL}/products/categories`).then(t=>t.data)}subscribe(t){return m.post(`${this.URL}/subscription`,{email:t})}order(t,e){return m.post(`${this.URL}/orders`,{email:t,products:e})}}const H=new T,U=document.querySelector(".cart-title");function R(){return(H.getFromStorage("cart")??[]).length}function $(){let s=R();U.innerHTML=`cart (${s})`}$();const k="/project-code_busters09/assets/cart-a9135e8e.svg",O="/project-code_busters09/assets/cartLight-0b4d3d6f.svg",_="/project-code_busters09/assets/discount-b955391f.svg",S="/project-code_busters09/assets/checked-295f5189.svg";function q(){document.addEventListener("click",function(s){if(s.target.classList.contains("cart-img-products")||s.target.classList.contains("main-cart-icon")||s.target.classList.contains("popular-cart-img")||s.target.classList.contains("popular-cart-img-down")){const t=s.target;t.src=S}})}function C(s){s.classList.add("visually-hidden")}function v(s){s.classList.remove("visually-hidden")}const h=document.querySelector(".loader-container");function D(){h&&(h.style.display="flex")}function b(){h&&(h.style.display="none")}const x=localStorage.getItem("options"),F=JSON.parse(x),w=document.querySelector(".no-products-message"),E=document.querySelector(".pagination"),A=document.querySelector(".filter-box__list"),z=document.querySelector(".popular-products__list"),W=document.querySelector(".discount-products__list"),i=new T,f=new P;document.addEventListener("click",function(s){s.target.tagName==="IMG"&&s.preventDefault()});i.defaultApiOptions();N();M();J();q();document.addEventListener("click",B);function B(s){if(s.target&&s.target.classList.contains("main-cart-icon")){const t=s.target.dataset.productId;i.addToCart(t),$(),N()}else if(s.target&&(s.target.classList.contains("cart-img-products")||s.target.classList.contains("popular-cart-img"))){const t=s.target.dataset.productId;f.findProductById(t).then(e=>{i.addProductToCart(e),$(),M(),J()})}}function N(){const s=JSON.parse(localStorage.getItem("options"));D(),f.getFoodListWithOptions2(s).then(t=>{t.totalPages<2||F.limit<6||t.results.length===0?C(E):v(E),t.results.length===0?v(w):C(w),console.log(t),A.innerHTML=G(t.results),b(),i.saveCardsToLocalStorage(t.results),i.createAndSave("pagination",t)}).catch(t=>{})}function M(){f.getPopular().then(s=>{z.innerHTML=K(s)}).catch(s=>{})}function J(){f.getDiscount().then(s=>{W.innerHTML=Q(s)}).catch(s=>{})}function G(s){const t=i.getCart();return s.map(({_id:e,name:r,img:o,category:c,price:a,popularity:u,size:p,is10PercentOff:l})=>{const n=document.createElement("img");n.src=k,n.classList.add("main-cart-icon"),n.dataset.productId=e;const g=document.createElement("img");g.src=_,g.classList.add("discount-icon-products");const L=l?g.outerHTML:"",d=document.createElement("img");d.src=S,d.classList.add("js-checked-arrow");const y=t.some(I=>I._id===e);return`<li class="product-card" data-id=${e}>
          ${L}
          <div class="img-container"><a href="${o}"><img class="product-card__img" src="${o}" alt="${r}" loading="lazy" /></a>
          </div>
          <div class="info">      
            <h2 class="info__title">${r}</h2>
            <div class="info-wrapper">
              <p class="info-wrapper__product">Category:<span>${c}</span></p>
              <p class="info-wrapper__product">Size:<span>${p}</span></p>
              <p class="info-wrapper__product">Popularity:<span>${u}</span></p>
            </div>
            <div class="info-wrapper__price-container" >
              <p class="info__price">$${a}</p> 
              ${y?d.outerHTML:n.outerHTML}
            </div>     
          </div>
        </li>`}).join("")}function K(s){const t=i.getCart();return s.map(({_id:e,name:r,img:o,category:c,popularity:a,size:u,is10PercentOff:p})=>{const l=document.createElement("img");l.src=O,l.classList.add("popular-cart-img"),l.dataset.productId=e;const n=document.createElement("img");n.src=O,n.classList.add("popular-cart-img-down");const g=document.createElement("img");g.src=_,g.classList.add("discount-icon-popular");const L=p?`${g.outerHTML}${n.outerHTML}`:`${l.outerHTML}`,d=document.createElement("img");d.src=S,d.classList.add("popular-cart-img"),d.dataset.productId=e;const y=t.some(I=>I._id===e);return`      
        <li class="popular-item" data-id="${e}">
            ${y?d.outerHTML:L}
          <div class="popular-img-container"><img class="popular-item__img" src="${o}" alt="${r}" loading="lazy" /></div>
          <div class="popular-info">
            <h3 class="popular-info__title">${r}</h3>
            <div class="info-wrapper">
              <p class="info-wrapper__product">Category:<span>${c}</span></p>
              <p class="info-wrapper__product">Size:<span>${u}</span></p>
              <p class="info-wrapper__product">Popularity:<span>${a}</span></p>
            </div>             
          </div>
        </li>`}).slice(0,5).join("")}function Q(s){const t=i.getCart();return s.map(({_id:e,name:r,img:o,price:c})=>{const a=document.createElement("img");a.src=k,a.classList.add("cart-img-products"),a.dataset.productId=e;const u=document.createElement("img");u.src=_,u.classList.add("discount-cheap");const p=document.createElement("img");p.src=S,p.classList.add("js-checked-arrow");const l=t.some(n=>n._id===e);return`      
      <li class="discount-item" data-id="${e}">
   
       ${u.outerHTML} 
      <div class="discount-img-container"><a href="${o}"><img class="discount-item__img" src="${o}" alt="${r}" loading="lazy" /></a>
      </div>
      <div class="discount-info">
        <h3 class="discount-info__title">${r}</h3>
        <div class="discount-img-wrapper">
        <p class="discount-info__price">$${c}</p>
         ${l?p.outerHTML:a.outerHTML}
        </div>        
      </div>
    </li>`}).slice(0,2).join("")}const V="/project-code_busters09/assets/icons-d9095b3f.svg";export{D as a,N as c,J as d,f,b as h,V as i,M as p,i as s,$ as u};
//# sourceMappingURL=icons-b05cf9dd.js.map
