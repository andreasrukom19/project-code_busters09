{"version":3,"file":"commonHelpers.js","sources":["../src/img/yellow_basket_desctop_1x-min.png","../src/img/yellow_basket_tablet_1x-min.png","../src/img/yellow_basket_mobile_1x-min.png","../src/img/yellow_basket_desctop_2x-min.png","../src/img/yellow_basket_tablet_2x-min.png","../src/img/yellow_basket_mobile_2x-min.png","../src/cart.js"],"sourcesContent":["export default \"__VITE_ASSET__22db5a51__\"","export default \"__VITE_ASSET__359a1065__\"","export default \"__VITE_ASSET__1afbb42c__\"","export default \"__VITE_ASSET__22b3ed6a__\"","export default \"__VITE_ASSET__77914d93__\"","export default \"__VITE_ASSET__b4656eb0__\"","import { foodService, storage } from './js/mainSection';\nimport { updateCartCountTitle } from './js/header';\n\nimport imgURLdesc from './img/yellow_basket_desctop_1x-min.png';\nimport imgURLtablet from './img/yellow_basket_tablet_1x-min.png';\nimport imgURLmob from './img/yellow_basket_mobile_1x-min.png';\nimport imgURLdesc2x from './img/yellow_basket_desctop_2x-min.png';\nimport imgURLtab2x from './img/yellow_basket_tablet_2x-min.png';\nimport imgURLmob2x from './img/yellow_basket_mobile_2x-min.png';\nimport iconsURL from './img/icons.svg';\nimport { showSpinner, hideSpinner } from './js/spinner';\n\nconst modalCart = document.querySelector('.modal-cart-submit');\nconst modalCartContent = document.querySelector('.cart-modal-content');\n\nconst cartContent = document.getElementById('cart-content');\ncartContent.addEventListener('click', clearCart);\nconst cartProductsContainer = document.querySelector(\n  '.cart_products_container'\n);\nconst cartHeader = document.querySelector('.cart-quentity');\n\nlet products = storage.getFromStorage('cart');\n\nfunction clearCart(e) {\n  if (!e.target.closest('.cart-delete-all-button')) {\n    return;\n  }\n  storage.clearCart();\n  updateCartCountTitle();\n  cartHeader.textContent = 'Cart(0)';\n  cartContent.innerHTML = createCartMarkupDefault();\n}\nfunction totalQuantity() {\n  if (products) {\n    const totalCount = products.length;\n    cartHeader.textContent = `Cart (${totalCount})`;\n  }\n}\ntotalQuantity();\n\nfunction calculateTotalPrice() {\n  let total = 0;\n  if (products) {\n    products.forEach(product => {\n      total += product.price;\n    });\n  }\n  return total.toFixed(2);\n}\n\nfunction checkLocalStorage() {\n  if (products && products.length !== 0) {\n    cartContent.innerHTML = createCartMarkup();\n  } else {\n    cartContent.innerHTML = createCartMarkupDefault();\n  }\n}\n\ncheckLocalStorage();\nconst cartProductsList = cartContent.querySelector('.cart_products_list');\ncreateCartMarkupProducts(products);\n\nfunction createCartMarkup() {\n  const total = calculateTotalPrice();\n  return `<div class=\"products_container\">\n  <div class=\"cart-add-products\">      \n    <div class=\"delete-all\">        \n      <button type=\"submit\" class=\"cart-delete-all-button\">Delete all            \n        <svg class=\"cart_close_all\" width=\"24\" height=\"24\">\n          <use xlink:href=\"${iconsURL}#icon-ion_close-sharp\"></use>\n        </svg>            \n      </button>          \n    </div>        \n    <div class=\"cart_products_container\">       \n      <ul class=\"cart_products_list\">                        \n        <!-- Add your products here -->            \n      </ul>          \n    </div>      \n  </div>      \n  <div class=\"products_order_container\">      \n    <p class=\"your_order\">Your Order</p>        \n    <div class=\"total-count\">          \n      <div class=\"total-count-div\">            \n        <p class=\"cart-total\">Total</p>            \n        <div class=\"cart-total-sum\">              \n          <p class=\"cart-sum\">Sum:</p>              \n          <p class=\"cart-sum-number\">$${total}</p>\n        </div>\n      </div>\n    </div>\n\n    <form class=\"order-form\">\n      <div class=\"cart-input\">\n        <label class=\"label-cart\">\n          <span class=\"label-mark\">Mail:</span>\n          <input\n            type=\"email\"\n            class=\"cart-email\"\n            id=\"email\"\n            placeholder=\"enter your email\"\n            multiple>\n        </label>\n      </div>\n      <div class=\"cart-btn\">\n        <button type=\"submit\" class=\"cart-checkout-button\">Checkout</button>\n      </div>\n    </form>\n    `;\n}\n\nfunction createCartMarkupProducts() {\n  if (products) {\n    const markup = products\n      .map(({ _id, name, img, category, size, price }) => {\n        let updateCategory = category.replace(/_/g, ' ');\n        return `\n    <li id=\"${_id}\" class=\"cart-list\">\n      <div class=\"obj-delete\">\n        <button class=\"cart-delete-button\">\n          <svg class=\"cart_close_all\" width=\"18\" height=\"18\">\n            <use xlink:href=\"${iconsURL}#icon-ion_close-sharp\"></use>\n          </svg>\n        </button>\n      </div>\n      <div class=\"cart-obj\">\n        <div class=\"add-img\">\n          <img src=\"${img}\" alt=\"Product Image\" class=\"product-image\" wi>\n        </div>\n        <div class=\"add-img-info\">\n          <p class=\"product-name\">${name}</p>\n          <div class=\"product-category-size\">\n            <p class=\"product-category\">Category: <span class=\"colored-text\">${updateCategory}</span></p>\n            <p class=\"product-size\">Size: <span class=\"colored-text\">${size}</span></p>\n          </div>\n          <p class=\"product-price\">$ ${price}</p>\n        </div>\n      </div>\n    </li>`;\n      })\n      .join('');\n    if (products.length === 0) return;\n    cartProductsList.innerHTML = markup;\n    const deleteBtns = document.querySelectorAll('.cart-delete-button');\n    deleteBtns.forEach(btn => btn.addEventListener('click', onDeleteProduct));\n  }\n}\n\nfunction onDeleteProduct(event) {\n  const productId = event.target.closest('li').id;\n  storage.removeFromCart(productId);\n  updateCartCountTitle();\n  products = storage.getFromStorage('cart');\n  if (products.length === 0) {\n    cartContent.innerHTML = createCartMarkupDefault();\n  }\n\n  const price = document.querySelector('.cart-sum-number');\n  if (price) {\n    price.textContent = calculateTotalPrice();\n  }\n\n  createCartMarkup();\n  createCartMarkupProducts();\n  totalQuantity();\n}\n\nfunction createCartMarkupDefault() {\n  return `  \n  <div class=\"box-img\">\n    <picture>\n      <source media=\"(min-width: 1440px)\" srcset=\"\n          ${imgURLdesc} 1x,\n          ${imgURLdesc2x} 2x\n        \" type=\"image/png\" />\n      <source media=\"(min-width: 768px)\" srcset=\"\n          ${imgURLtablet} 1x,\n          ${imgURLtab2x} 2x\n        \" type=\"image/png\" />\n      <source media=\"(min-width: 320px)\" srcset=\"\n          ${imgURLmob} 1x,\n          ${imgURLmob2x} 2x\n        \" type=\"image/png\" />\n      <img class=\"cart-img\" src=\"${imgURLdesc}\" alt=\"basket\" />\n    </picture>\n  </div>\n  <div class=\"cart-empty\">\n    <p class=\"cart-message\">\n      Your basket is <span class=\"hero-title-span\">empty...</span>\n    </p>\n    <p class=\"cart-message-info\">\n      Go to the main page to select your favorite products and add them to\n      the cart.\n    </p>\n  </div>\n</div>`;\n}\n\nif (document.querySelector('.order-form')) {\n  const orderForm = document.querySelector('.order-form');\n  orderForm.addEventListener('submit', onCheckoutSubmit);\n\n  function onCheckoutSubmit(e) {\n    e.preventDefault();\n\n    const totalCart = storage\n      .getCart()\n      .map(elem => ({ productId: elem._id, amount: 1 }));\n    const emailInput = document.querySelector('.cart-email');\n    if (!emailInput.value) {\n      return;\n    }\n\n    foodService\n      .order(emailInput.value, totalCart)\n      .then(result => {\n        const message = result.data.message;\n        storage.clearCart();\n        updateCartCountTitle();\n        cartHeader.textContent = 'Cart(0)';\n        cartContent.innerHTML = createCartMarkupDefault();\n        modalCartContent.innerHTML = makeModalMarkup(message);\n        openModal();\n      })\n      .catch(err => {\n        console.log(err);\n      })\n      .finally();\n  }\n}\n\nfunction openModal() {\n  modalCart.style.display = 'block';\n  document.body.classList.add('no-scroll');\n  document.addEventListener('keydown', onEscCloseModal);\n  window.addEventListener('click', onClickCloseModal);\n}\n\nfunction closeModal() {\n  modalCart.style.display = 'none';\n  document.removeEventListener('keydown', onEscCloseModal);\n  window.removeEventListener('click', onClickCloseModal);\n  document.body.classList.remove('no-scroll');\n}\n\nfunction onEscCloseModal(e) {\n  if (e.key === 'Escape') {\n    closeModal();\n  }\n}\n\nfunction onClickCloseModal(e) {\n  if (e.target.classList.contains('cart-modal-content')) {\n    // закриття по кліку по бекдропу\n    closeModal();\n  } else if (e.target.closest('.cart-delete-modal')) {\n    // закриття по кліку по кнопці з класом '.modal-btn-close'\n    closeModal();\n  }\n}\n\nfunction makeModalMarkup(message) {\n  let messageTitle = message.substring(\n    0,\n    message.indexOf('Thank you for shopping')\n  );\n  let messageText = message.substring(\n    message.indexOf('Thank you for shopping')\n  );\n  messageTitle = messageTitle.toUpperCase().replace('!', '');\n  return `\n  <button class=\"cart-delete-modal\">\n    <svg class=\"cart_close_all\" width=\"18\" height=\"18\">\n      <use xlink:href=\"${iconsURL}#icon-ion_close-sharp\"></use>\n    </svg>\n  </button>\n  <img class=\"cart-modal-img\" src=\"${imgURLdesc}\" alt=\"basket\" />\n  \n  <h1 class=\"cart-success\">${messageTitle}</h1>\n  <p class=\"cart-modal-info\">${messageText}</p>\n  `;\n}\n"],"names":["imgURLdesc","imgURLtablet","imgURLmob","imgURLdesc2x","imgURLtab2x","imgURLmob2x","modalCart","modalCartContent","cartContent","clearCart","cartHeader","products","storage","e","updateCartCountTitle","createCartMarkupDefault","totalQuantity","totalCount","calculateTotalPrice","total","product","checkLocalStorage","createCartMarkup","cartProductsList","createCartMarkupProducts","iconsURL","markup","_id","name","img","category","size","price","updateCategory","btn","onDeleteProduct","event","productId","onCheckoutSubmit","totalCart","elem","emailInput","foodService","result","message","makeModalMarkup","openModal","err","onEscCloseModal","onClickCloseModal","closeModal","messageTitle","messageText"],"mappings":"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"}